https://juejin.im/post/6844903604868874247
https://zhuanlan.zhihu.com/p/141458270

# TCP：应用程序之间的通信

1. 保证数据包以正确的次序到达，并保证内容一致性；
2. 用于应用程序到网络的数据传输控制

# IP：计算机之间的通信

1. 每台计算机有一个IP
2. IP负责在internet中发送和接受包

# TCP和IP的工作

1. TCP负责应用程序（浏览器）和网络软件之间的通信
2. IP负责电脑之间的通信
3. TCP把数据分割放入IP包，IP负责把包发送到接收方，到达后由TCP组装

# HTTP

## HTTP协议层

HTTP是基于TCP实现的应用层协议

1. 应用层：
   1. FTP：文件传输协议
   2. HTTP：超文本传输协议
   3. SMTP：简单邮件传输协议
   4. POP3：邮局协议
   5. DNS：域名系统
2. 传输层：
   1. TCP：传输控制协议
   2. UDP：用户数据协议
3. 互联网层：
   1. IP：网络协议
   2. ARP：地址解析协议
   3. ICMP：internet控制消息协议
   4. HDLC：高级数据链路控制
4. 数据链路层：SLIP（串行线路IP），PPP（点到点协议）
5. 物理层：放大或再生弱信号，在两个电缆段之间复制每一个bit

## HTTP请求响应模型

1. 客户端发起请求，服务器回送响应
2. HTTP是无状态协议，客户端于服务器不需要建立持久连接

## HTTP的工作过程

1. 地址解析：
   1. 协议名：http
   2. IP+端口 （dns解析）
   3. 对象路径：uri
2. 封装HTTP请求数据包
3. 封装成TCP包，建立TCP连接（TCP的三次握手）
4. 客户机发送请求命令
5. 服务器响应
6. 服务器关闭TCP连接

## HTTP缺点

1. 明文传递
2. 不验证身份，可能被伪装
3. 无法验证完整性

# HTTPS

1. HTTP + 加密 + 认证 + 完整性保护 = HTTPS
2. TLS/SSL 是介于TCP和HTTP之前的一层安全协议，不影响原有的TCP和HTTP协议

## TLS/SSL工作原理

1. 主要功能依赖：HASH算法， 对称加密，非对称加密
2. 非对称加密用于身份认证和密钥协商
3. 对称加密采用协商好的密钥，进行数据加密
4. 基于hash算法验证数据完整性
5. CA证书 保证证书合法能标识服务器身份
6. 详情参考：http://note.youdao.com/noteshare?id=3e6f0a296ccae4b79eb5d3004f3a953e&sub=CC410CEABFA2426C917B07986CBBB667

# SPDY

# HTTP2

1. HTTP2.0改变了客户端与服务器交换数据的方式
2. HTTP2.0增加了二进制分帧数据层，这一层不兼容1.1

## HTTP1.1的问题

1. 队头阻塞
2. TCP慢启动导致的最初传输速率不高，对于数据量小的HTTP请求来说效率很低
3. header臃肿，无法压缩
4. 无优先级限制

## 二进制分帧层

1. 把请求拆成了多个帧
2. 帧的类型：![image](https://pic4.zhimg.com/80/v2-9c7db5d486e2cae3e864b5933fac2324_720w.jpg)

## 多路复用

1. 所有请求和响应都在同一个TCP连接上发送：客户端和服务器把HTTP消息分解成多个帧，然后乱序发送，最后在另一端组合起来
2. 响应和请求间不互相影响
3. 一个连接并行发送多个请求和响应
4. 消除不必要的延迟，从而减少页面加载的时间
5. 不必再为绕过 HTTP 1.x 限制而多做很多工作；

## 优先级

1. 把消息拆分为帧后，可以优化帧的交错和传输顺序
2. 通过headers帧和priority帧，客户端可以明确地和服务器沟通需要的内容和顺序
3. 服务器可以根据流的优先级控制分配资源

## 流量控制

1. 对帧进行进行流量控制

## 服务器推送

1. 服务器还可以额外向客户端推送资源，而无需客户端明确地请求
2. 客户端也可以拒绝服务端推送
3. 可以用于多个资源的推送，无需客户端请求

## 头部压缩

1. HTTP2通过“首部表”来跟踪存储之前发送的key-value值对，对于相同的数据，不在每次请求和响应

## http1.1的性能优化取消

1. 取消合并资源，因为都在同一个tcp连接
2. 取消域名拆分，不再需要突破浏览器的TCP连接数限制
